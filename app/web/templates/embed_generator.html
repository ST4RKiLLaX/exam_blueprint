{% extends "base.html" %}

{% block title %}Embed - {{ agent.name }} - ExamBlueprint{% endblock %}

{% block content %}
<div class="max-w-4xl mx-auto space-y-8">
    <!-- Header -->
    <div class="text-center">
        <h1 class="text-3xl font-bold text-gray-900 mb-2">ðŸ”— Embed Code Generator</h1>
        <p class="text-gray-600">Generate embed codes to add {{ agent.name }} to your website</p>
    </div>

    <!-- Agent Info -->
    <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
        <div class="flex items-center space-x-4">
            <div class="w-16 h-16 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center">
                <span class="text-white font-bold text-xl">ðŸ¤–</span>
            </div>
            <div>
                <h2 class="text-2xl font-bold text-gray-900">{{ agent.name }}</h2>
                <p class="text-gray-600">{{ agent.personality[:100] }}...</p>
                <div class="flex items-center space-x-2 mt-2">
                    <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800">
                        Active
                    </span>
                    <span class="text-sm text-gray-500">{{ agent.knowledge_bases|length }} knowledge bases</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Embed Options -->
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
        <!-- Iframe Embed -->
        <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
            <div class="flex items-center space-x-2 mb-4">
                <svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path>
                </svg>
                <h3 class="text-lg font-semibold text-gray-900">Iframe Embed</h3>
            </div>
            <p class="text-sm text-gray-600 mb-4">Simple iframe that can be added to any HTML page</p>
            <div class="bg-gray-50 rounded-lg p-3 mb-4">
                <code class="text-xs text-gray-800 break-all">{{ embed_codes.iframe }}</code>
            </div>
            <button onclick="copyToClipboard('{{ embed_codes.iframe }}')" class="w-full bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors">
                Copy Code
            </button>
        </div>

        <!-- JavaScript Embed -->
        <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
            <div class="flex items-center space-x-2 mb-4">
                <svg class="w-6 h-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"></path>
                </svg>
                <h3 class="text-lg font-semibold text-gray-900">JavaScript Embed</h3>
            </div>
            <p class="text-sm text-gray-600 mb-4">Dynamic script loading for more control</p>
            <div class="bg-gray-50 rounded-lg p-3 mb-4">
                <code class="text-xs text-gray-800 break-all">{{ embed_codes.javascript }}</code>
            </div>
            <button onclick="copyToClipboard('{{ embed_codes.javascript }}')" class="w-full bg-green-600 text-white py-2 px-4 rounded-lg hover:bg-green-700 transition-colors">
                Copy Code
            </button>
        </div>

        <!-- Direct Link -->
        <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
            <div class="flex items-center space-x-2 mb-4">
                <svg class="w-6 h-6 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"></path>
                </svg>
                <h3 class="text-lg font-semibold text-gray-900">Direct Link</h3>
            </div>
            <p class="text-sm text-gray-600 mb-4">Direct URL to the chat widget</p>
            <div class="bg-gray-50 rounded-lg p-3 mb-4">
                <code class="text-xs text-gray-800 break-all">{{ embed_codes.direct_link }}</code>
            </div>
            <button onclick="copyToClipboard('{{ embed_codes.direct_link }}')" class="w-full bg-purple-600 text-white py-2 px-4 rounded-lg hover:bg-purple-700 transition-colors">
                Copy URL
            </button>
        </div>
    </div>

    <!-- Preview Section -->
    <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
        <h3 class="text-lg font-semibold text-gray-900 mb-4">ðŸŽ¯ Live Preview</h3>
        <p class="text-sm text-gray-600 mb-4">See how the chat widget will look on your website</p>
        
        <div class="border border-gray-200 rounded-lg bg-gray-50 p-4">
            <iframe 
                src="/embed/{{ agent_id }}" 
                width="100%" 
                height="500" 
                frameborder="0"
                class="rounded-lg shadow-sm">
            </iframe>
        </div>
    </div>

    <!-- Implementation Guide -->
    <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
        <h3 class="text-lg font-semibold text-gray-900 mb-4">ðŸ“š Implementation Guide</h3>
        
        <div class="space-y-4">
            <div class="border-l-4 border-blue-500 pl-4">
                <h4 class="font-medium text-gray-900">Step 1: Choose Embed Method</h4>
                <p class="text-sm text-gray-600 mt-1">Select the embed method that best fits your website's needs</p>
            </div>
            
            <div class="border-l-4 border-green-500 pl-4">
                <h4 class="font-medium text-gray-900">Step 2: Copy the Code</h4>
                <p class="text-sm text-gray-600 mt-1">Click the copy button to copy the embed code to your clipboard</p>
            </div>
            
            <div class="border-l-4 border-purple-500 pl-4">
                <h4 class="font-medium text-gray-900">Step 3: Paste in Your Website</h4>
                <p class="text-sm text-gray-600 mt-1">Paste the code into your HTML where you want the chat widget to appear</p>
            </div>
            
            <div class="border-l-4 border-orange-500 pl-4">
                <h4 class="font-medium text-gray-900">Step 4: Test the Integration</h4>
                <p class="text-sm text-gray-600 mt-1">Visit your website to ensure the chat widget is working correctly</p>
            </div>
        </div>
    </div>

    <!-- Customization Options -->
    <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
        <h3 class="text-lg font-semibold text-gray-900 mb-4">ðŸŽ¨ Customization Options</h3>
        
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div class="p-4 bg-blue-50 rounded-lg border border-blue-200">
                <h4 class="font-medium text-blue-900 mb-2">Size & Position</h4>
                <p class="text-sm text-blue-700">Modify the width, height, and positioning in the iframe code</p>
            </div>
            
            <div class="p-4 bg-green-50 rounded-lg border border-green-200">
                <h4 class="font-medium text-green-900 mb-2">Styling</h4>
                <p class="text-sm text-green-700">Add custom CSS to match your website's design</p>
            </div>
            
            <div class="p-4 bg-purple-50 rounded-lg border border-purple-200">
                <h4 class="font-medium text-purple-900 mb-2">Behavior</h4>
                <p class="text-sm text-purple-700">Control when and how the chat widget appears</p>
            </div>
            
            <div class="p-4 bg-orange-50 rounded-lg border border-orange-200">
                <h4 class="font-medium text-orange-900 mb-2">Integration</h4>
                <p class="text-sm text-orange-700">Integrate with your existing analytics and tracking</p>
            </div>
        </div>
    </div>
</div>

<script>
function copyToClipboard(text) {
    navigator.clipboard.writeText(text).then(function() {
        // Show success message
        const button = event.target;
        const originalText = button.textContent;
        button.textContent = 'Copied!';
        button.classList.add('bg-green-600');
        button.classList.remove('bg-blue-600', 'bg-green-600', 'bg-purple-600');
        
        setTimeout(function() {
            button.textContent = originalText;
            button.classList.remove('bg-green-600');
            if (originalText.includes('iframe')) {
                button.classList.add('bg-blue-600');
            } else if (originalText.includes('JavaScript')) {
                button.classList.add('bg-green-600');
            } else {
                button.classList.add('bg-purple-600');
            }
        }, 2000);
    }).catch(function(err) {
        console.error('Failed to copy: ', err);
        alert('Failed to copy to clipboard. Please copy manually.');
    });
}
</script>
{% endblock %}
